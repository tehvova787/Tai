# Микросервисная архитектура Lucky Train AI

## Структура микросервисов

1. **API Gateway Service**
   - Централизованная точка входа для всех клиентов
   - Аутентификация и авторизация
   - Rate limiting и балансировка нагрузки

2. **Assistant Core Service**
   - Обработка запросов пользователей
   - Управление контекстом диалога
   - Маршрутизация к специализированным сервисам

3. **Knowledge Base Service**
   - Управление векторной базой данных
   - Индексация и поиск по базе знаний
   - Интеграция с RAG (Retrieval Augmented Generation)

4. **AI Model Service**
   - Взаимодействие с языковыми моделями
   - Локальное выполнение малых моделей
   - Проксирование запросов к внешним API (OpenAI и др.)

5. **Blockchain Integration Service**
   - Взаимодействие с TON блокчейном
   - Управление NFT и токенами
   - Верификация транзакций

6. **User Management Service**
   - Управление пользователями и профилями
   - Персонализация взаимодействия
   - История запросов и предпочтения

7. **Metaverse Connector Service**
   - Интеграция с метавселенной
   - Управление аватарами и объектами
   - Пространственное позиционирование

## Взаимодействие между сервисами

- Асинхронная коммуникация через RabbitMQ/Kafka
- Синхронные запросы через RESTful API и gRPC
- Единая схема авторизации на основе JWT

## План миграции

1. **Фаза 1**: Выделение API Gateway и Assistant Core
   - Настройка контейнеризации
   - Внедрение базового API Gateway
   - Настройка балансировки нагрузки

2. **Фаза 2**: Отделение Knowledge Base и AI Model сервисов
   - Миграция векторной БД в отдельный сервис
   - Создание промежуточного слоя для языковых моделей
   - Настройка кэширования и оптимизация запросов

3. **Фаза 3**: Выделение вспомогательных сервисов
   - Создание Blockchain Integration Service
   - Создание User Management Service
   - Создание Metaverse Connector Service

4. **Фаза 4**: Внедрение оркестрации и мониторинга
   - Настройка Kubernetes кластера
   - Внедрение Prometheus и Grafana
   - Настройка автоматического масштабирования

## Технический стек

- **Контейнеризация**: Docker
- **Оркестрация**: Kubernetes
- **Обмен сообщениями**: RabbitMQ/Kafka
- **API Gateway**: Kong/Traefik
- **Мониторинг**: Prometheus + Grafana
- **CI/CD**: GitHub Actions/Jenkins
- **Логирование**: ELK Stack (Elasticsearch, Logstash, Kibana)

## Требования к инфраструктуре

- Минимум 3 узла для Kubernetes кластера
- Минимум 16 GB RAM на каждый узел
- SSD хранилище для базы данных и векторного хранилища
- Выделенное хранилище для журналов и мониторинга 