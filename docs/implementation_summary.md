# Интеграция LLM в Lucky Train AI Assistant

## Обзор реализованных изменений

В рамках улучшения AI-ассистента Lucky Train были внедрены следующие изменения:

1. **Интеграция с OpenAI API**
   - Добавлена поддержка использования современных языковых моделей (GPT-3.5-Turbo/GPT-4)
   - Реализация механизма переключения между LLM и TF-IDF при недоступности API

2. **Retrieval Augmented Generation (RAG)**
   - Улучшен процесс поиска релевантной информации в базе знаний
   - Внедрен механизм предоставления контекста языковой модели для генерации точных ответов
   - Добавлен запасной TF-IDF механизм поиска при проблемах с LLM

3. **Улучшение конфигурации**
   - Добавлены настройки языковой модели в config.json
   - Создан механизм загрузки переменных окружения с использованием python-dotenv
   - Улучшена проверка обязательных переменных окружения при запуске

4. **Улучшение документации**
   - Создана детальная документация по интеграции с LLM в docs/llm_integration.md
   - Обновлен README.md с информацией о новых возможностях
   - Добавлены примеры использования и решения проблем

## Технические детали

### Реализация RAG

Процесс Retrieval Augmented Generation реализован следующим образом:
1. Пользовательский запрос анализируется для определения темы и ключевых слов
2. Система извлекает релевантные фрагменты из базы знаний с использованием поиска по ключевым словам
3. Эти фрагменты объединяются в контекст для языковой модели
4. Языковая модель генерирует ответ, основываясь на предоставленном контексте и запросе
5. При недоступности LLM система автоматически переключается на традиционный механизм ответов

### Отказоустойчивость

Система разработана с учетом отказоустойчивости:
- Если API ключ не предоставлен, используется TF-IDF механизм
- При сбоях в работе API происходит автоматическое переключение на резервный механизм
- Все ошибки логируются для дальнейшего анализа

### Зависимости

Добавлены новые зависимости:
- openai>=1.0.0: Клиент для работы с OpenAI API
- python-dotenv>=1.0.0: Управление переменными окружения

## Следующие шаги

В дальнейшем планируется реализовать:

1. **Улучшение векторного поиска**
   - Использование OpenAI Embeddings API для создания и поиска по векторным представлениям
   - Реализация семантического поиска вместо простого поиска по ключевым словам

2. **Кэширование и оптимизация**
   - Кэширование результатов запросов к API для снижения расходов
   - Оптимизация промптов для более точных ответов

3. **Многоязычность**
   - Добавление поддержки нескольких языков с автоматическим определением языка запроса

4. **Интеграция с TON API**
   - Получение актуальных данных о токене и блокчейне в реальном времени 